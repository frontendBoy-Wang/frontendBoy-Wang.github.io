{"title":"pythonå¤šçº¿ç¨‹çˆ¬è™«-ä¸‹è½½wallhavenè¶…æ¸…å£çº¸","uid":"4112198ee0b9e47478edd7a567ce5aa9","slug":"python/pythonå¤šçº¿ç¨‹çˆ¬è™«-ä¸‹è½½wallhavenè¶…æ¸…å£çº¸","date":"2023-04-12T02:46:35.000Z","updated":"2024-12-25T06:40:06.000Z","comments":true,"path":"api/articles/python/pythonå¤šçº¿ç¨‹çˆ¬è™«-ä¸‹è½½wallhavenè¶…æ¸…å£çº¸.json","keywords":"å‰ç«¯å°‘å¹´æ±ª,å‰ç«¯,åç«¯,å…¨æ ˆå·¥ç¨‹å¸ˆ,ç¨‹åºå‘˜,vue,react,Golang,Java,JavaScript,Python,frontendBoy-Wang","cover":"../img/42.png","content":"<p><img src=\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/762e1bfaf9d04c7e8a468a2ed7f5275e~tplv-k3u1fbpfcp-zoom-1.image\" alt=\"9-wallhaven-exwgw8.png\"></p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>å¤§å®¶å¥½æˆ‘æ˜¯å‰ç«¯å°‘å¹´æ±ªï¼ç—´è¿·æŠ€æœ¯ï¼Œå¯¹programmingæœ‰ç€æå¤§çš„å…´è¶£å’Œçˆ±å¥½ã€‚<br>ä»æ˜å¤©èµ·ï¼Œåšä¸€ä¸ªæ–°æ€ç»´çš„äºº ç»§æ‰¿ï¼Œå¤šæ€ï¼Œå±‚å±‚å°è£… ä»æ˜å¤©èµ·,ä¸å†å…³å¿ƒå†…å­˜ç®¡ç† è®©æ¯ä¸€æ¡æ•°æ®ï¼Œè‡ªåŠ¨æ”¾åˆ°åˆé€‚çš„ä½å­ä¸Š ä»æ˜å¤©èµ·ï¼Œæˆ‘å°†ä¸ºæ¯ä¸€ä¸ªå¯¹è±¡ å–ä¸€ä¸ªæ¸©æš–çš„åå­— å®ƒä»¬ç”¨é©¼å³°å‘½åï¼Œä¼˜é›…ï¼Œå¤§æ–¹ é™Œç”Ÿäººï¼Œæˆ‘ä¹Ÿç¥ç¦ä½ å“ˆ æ„¿ä½ ä¸å†ä¸ºç³»ç»Ÿçº§bugçƒ¦æ¼ æ„¿ä½ åœ¨å¹³å°ä¹‹é—´è‚†æ„æ¸¸è¡ æ„¿ä½ ä¸å†å…³å¿ƒæº¢å‡ºä¸å¼‚å¸¸</p></blockquote>\n<p>çˆ¬å–çš„ç›®æ ‡ç½‘ç«™ï¼š<a href=\"https://wallhaven.cc/\">https://wallhaven.cc/</a></p>\n<p><img src=\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/08efb230169c4fbfb7f218b58c099b49~tplv-k3u1fbpfcp-watermark.image\" alt=\"image.png\"></p>\n<p>ä½¿ç”¨åˆ°çš„åº“ï¼š</p>\n<ul>\n<li>  requests</li>\n<li>  Xpath</li>\n</ul>\n<h2 id=\"åˆ†æç›®æ ‡ç½‘ç«™çš„DOMç»“æ„\"><a href=\"#åˆ†æç›®æ ‡ç½‘ç«™çš„DOMç»“æ„\" class=\"headerlink\" title=\"åˆ†æç›®æ ‡ç½‘ç«™çš„DOMç»“æ„\"></a>åˆ†æç›®æ ‡ç½‘ç«™çš„DOMç»“æ„</h2><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ªç½‘ç«™æ€»å…±åˆ†ä¸ºå…­ä¸ªå¤§çš„æ¨¡å—ï¼š<strong>Latestï¼ŒHotï¼ŒToplistï¼ŒRandomï¼ŒUploadï¼ŒForums</strong><br>æˆ‘çˆ¬å–çš„ä¸»è¦æ˜¯latestï¼Œhotï¼Œtoplistï¼Œrandomè¿™å››ä¸ªæ¨¡å—çš„å›¾ç‰‡.<br>è¿™å››ä¸ªæ¨¡å—å¯¹åº”çš„urlç½‘å€åˆ†åˆ«ä¸ºï¼š</p>\n<ul>\n<li>  <a href=\"https://wallhaven.cc/latest\">https://wallhaven.cc/</a>latest</li>\n<li>  <a href=\"https://wallhaven.cc/latest\">https://wallhaven.cc/</a>hot</li>\n<li>  <a href=\"https://wallhaven.cc/latest\">https://wallhaven.cc/</a>toplist</li>\n<li>  <a href=\"https://wallhaven.cc/latest\">https://wallhaven.cc/</a>random</li>\n</ul>\n<p>å›¾ç‰‡çš„é¢„è§ˆé¡µé¢</p>\n<p><img src=\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c8503b5d9f1a46bc9119d10d68359484~tplv-k3u1fbpfcp-zoom-1.image\" alt=\"image.png\"></p>\n<p>è¿™é‡Œå¯ä»¥çœ‹åˆ°page=2çš„é¡µé¢æ€»å…±ğŸˆ¶ï¸24å¼ å›¾ç‰‡ï¼Œè¿™ä¸ªåªæ˜¯ç¼©ç•¥å›¾ï¼Œç‚¹å‡»å•ä¸ªitemé¡¹å°±å¯ä»¥è¿›å…¥åˆ°å›¾ç‰‡çš„è¯¦æƒ…é¡µï¼Œå¯ä»¥çœ‹åˆ°å¯¹åº”çš„å›¾ç‰‡çš„è¯¦æƒ…é¡µé¢çš„urlåœ¨section&gt;ul&gt;li&gt;figure&gt;aæ ‡ç­¾çš„hrefå±æ€§ä¸­ã€‚</p>\n<p>å›¾ç‰‡çš„è¯¦æƒ…é¡µ</p>\n<p><img src=\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/194cf7b7fea446dea0cfe161b4126d64~tplv-k3u1fbpfcp-zoom-1.image\" alt=\"image.png\"></p>\n<p>å¯ä»¥çœ‹åˆ°çœŸæ­£çš„å›¾ç‰‡çš„urlæ˜¯å­˜åœ¨äºimgæ ‡ç­¾çš„srcå±æ€§ï¼Œåªè¦æˆ‘ä»¬æ‹¿åˆ°è¿™ä¸ªå›¾ç‰‡çš„åœ°å€å°±å¯ä»¥ä¸‹è½½å›¾ç‰‡åˆ°æœ¬åœ°äº†ã€‚</p>\n<h2 id=\"æ¢³ç†ä¸€ä¸‹é€»è¾‘ï¼š\"><a href=\"#æ¢³ç†ä¸€ä¸‹é€»è¾‘ï¼š\" class=\"headerlink\" title=\"æ¢³ç†ä¸€ä¸‹é€»è¾‘ï¼š\"></a>æ¢³ç†ä¸€ä¸‹é€»è¾‘ï¼š</h2><ol>\n<li> è¯·æ±‚latestï¼Œhotï¼Œtoplistï¼Œrandomå››ä¸ªæ¨¡å—ä¸­çš„ä»»æ„ä¸€ä¸ªé¡µé¢è·å–åˆ°ç¼©ç•¥å›¾çš„aæ ‡ç­¾é‡Œé¢çš„urlï¼Œä¿å­˜åˆ°ä¸€ä¸ªåˆ—è¡¨é‡Œé¢</li>\n<li> éå†ç¼©ç•¥å›¾åˆ—è¡¨ï¼Œè·å–è¯¦æƒ…é¡µimgæ ‡ç­¾çš„srcå›¾ç‰‡åœ°å€</li>\n<li> è¯·æ±‚å›¾ç‰‡åœ°å€ï¼Œä¸‹è½½ä¿å­˜åˆ°æœ¬åœ°</li>\n</ol>\n<p>å¤§æ¦‚çš„é€»è¾‘å°±æ˜¯è¿™ä¹ˆç®€å•</p>\n<h3 id=\"ä»£ç å®ç°\"><a href=\"#ä»£ç å®ç°\" class=\"headerlink\" title=\"ä»£ç å®ç°\"></a>ä»£ç å®ç°</h3><h4 id=\"å¯¼å…¥ç›¸å…³åŒ…ï¼Œå®šä¹‰å…¨å±€å˜é‡\"><a href=\"#å¯¼å…¥ç›¸å…³åŒ…ï¼Œå®šä¹‰å…¨å±€å˜é‡\" class=\"headerlink\" title=\"å¯¼å…¥ç›¸å…³åŒ…ï¼Œå®šä¹‰å…¨å±€å˜é‡\"></a>å¯¼å…¥ç›¸å…³åŒ…ï¼Œå®šä¹‰å…¨å±€å˜é‡</h4><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">import os\nimport threading\n\nimport requests\nfrom lxml import etree\n\n&quot;&quot;&quot;\nçˆ¬å–ç½‘ç«™ï¼šhttps:&#x2F;&#x2F;wallhaven.cc&#x2F;\n&quot;&quot;&quot;\n# ä¼ªè£…æµè§ˆå™¨è¯·æ±‚\nheaders &#x3D; &#123;\n    &#39;user-agent&#39;: &#39;Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;106.0.0.0 Safari&#x2F;537.36&#39;\n&#125;\n# å­˜æ”¾ä¸‹è½½å›¾ç‰‡çš„æ–‡ä»¶å¤¹åç§°\nnew_folder &#x3D; &#39;img&#39;\n# 5ä¸ªæ¨¡å—å¯¹åº”çš„å­—ç¬¦ä¸²åˆ—è¡¨\ntype_list &#x3D; [&#39;hot&#39;, &#39;toplist&#39;, &#39;latest&#39;, &#39;random&#39;]\n# çº¿ç¨‹æ± \nthreads &#x3D; []</code></pre>\n\n<h4 id=\"è·å–ç¼©ç•¥å›¾é¡µé¢\"><a href=\"#è·å–ç¼©ç•¥å›¾é¡µé¢\" class=\"headerlink\" title=\"è·å–ç¼©ç•¥å›¾é¡µé¢\"></a>è·å–ç¼©ç•¥å›¾é¡µé¢</h4><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"># å•é¡µä¸‹è½½ï¼Œåªä¸‹è½½ä¸€é¡µ24å¼ å›¾ç‰‡\ndef get_wall_one_page(type_index: int, page_num) -&gt; None:\n    # page_numçˆ¬å–çš„é¡µç \n    url &#x3D; &#39;https:&#x2F;&#x2F;wallhaven.cc&#x2F;&#123;&#125;?page&#x3D;&#123;&#125;&#39;.format(type_list[type_index], page_num)\n    print(url)\n    # è·å–å½“å‰ç›®å½•\n    current_dir &#x3D; os.getcwd()\n\n    # æ–°æ–‡ä»¶å¤¹çš„åç§°\n    # new_folder &#x3D; &#39;img_&#123;&#125;&#39;.format(type_list[type_index])  # åˆ›å»ºæ–°æ–‡ä»¶å¤¹\n    if not os.path.exists(new_folder):\n        os.mkdir(os.path.join(current_dir, new_folder))\n\n    res &#x3D; requests.get(url, headers&#x3D;headers).text\n    selector &#x3D; etree.HTML(res)\n    img_urls &#x3D; selector.xpath(&#39;&#x2F;&#x2F;a[@class&#x3D;\\&#39;preview\\&#39;]&#x2F;@href&#39;)\n    # è°ƒç”¨è·å–è¯¦æƒ…é¡µæ–¹æ³•\n    detail_img(img_urls)</code></pre>\n\n<p><img src=\"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/93134b340e41465198ec38726153e6ca~tplv-k3u1fbpfcp-watermark.image#id=iImhK&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=\"></p>\n<h4 id=\"è·å–å›¾ç‰‡è¯¦æƒ…é¡µé¢\"><a href=\"#è·å–å›¾ç‰‡è¯¦æƒ…é¡µé¢\" class=\"headerlink\" title=\"è·å–å›¾ç‰‡è¯¦æƒ…é¡µé¢\"></a>è·å–å›¾ç‰‡è¯¦æƒ…é¡µé¢</h4><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">def detail_img(img_urls):\n    &quot;&quot;&quot;\n    å›¾ç‰‡è¯¦æƒ…\n    :param img_urls:è·å–åˆ°å•ä¸ªå›¾ç‰‡itemçš„è¯¦æƒ…url\n    :return:\n    &quot;&quot;&quot;\n    i &#x3D; 0\n\n    for item in img_urls:\n        son_res &#x3D; requests.get(item, headers&#x3D;headers).text\n        selector &#x3D; etree.HTML(son_res)\n        src_arr &#x3D; selector.xpath(&#39;&#x2F;&#x2F;img[@id&#x3D;\\&#39;wallpaper\\&#39;]&#x2F;@src&#39;)\n        # ä½¿ç”¨å¤šçº¿ç¨‹ä¸‹è½½å›¾ç‰‡ï¼Œè°ƒç”¨ä¸‹è½½æ–¹æ³•\n        t &#x3D; threading.Thread(target&#x3D;download_img, args&#x3D;(src_arr[0], i))\n        t.start()\n        threads.append(t)\n        # download_img(src_arr[0], i)\n\n        i +&#x3D; 1\n        # ç­‰å¾…æ‰€æœ‰çº¿ç¨‹å®Œæˆ\n    for t in threads:\n        t.join()\n    print(&quot;å½“å‰é¡µæ‰€æœ‰å›¾ç‰‡ä¸‹è½½å®Œæˆ&quot;)</code></pre>\n\n<h4 id=\"ä¸‹è½½å›¾ç‰‡\"><a href=\"#ä¸‹è½½å›¾ç‰‡\" class=\"headerlink\" title=\"ä¸‹è½½å›¾ç‰‡\"></a>ä¸‹è½½å›¾ç‰‡</h4><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">def download_img(img_src, i):\n    &quot;&quot;&quot;\n    å›¾ç‰‡ä¸‹è½½\n    :param img_src: å›¾ç‰‡çš„src\n    :param i: åºå·\n    :return: void\n    &quot;&quot;&quot;\n    with open(&#39;.&#x2F;&#123;&#125;&#x2F;&#123;&#125;-&#123;&#125;&#39;.format(new_folder, i, img_src.split(&#39;&#x2F;&#39;)[-1]), &#39;wb&#39;) as f:\n        f.write(requests.get(img_src).content)\n    print(i, img_src)</code></pre>\n\n<p>ä»¥ä¸Šå°±æ˜¯çˆ¬å–å•é¡µï¼ˆä¸€é¡µ24å¼ å›¾ç‰‡çš„æ–¹æ³•ï¼‰ï¼Œè§‚å¯Ÿurlå¯ä»¥å¾—çŸ¥ï¼Œé€šè¿‡æ”¹å˜pageè¿™ä¸ªå‚æ•°å°±å¯ä»¥ä¸æ–­çˆ¬å–ä¸åŒé¡µç çš„å›¾ç‰‡äº†ã€‚å¯ä»¥æœ‰2ç§ä¸åŒçš„æ€è·¯ï¼š</p>\n<ol>\n<li> çˆ¬å–æ‰€æœ‰é¡µï¼Œä»1åˆ°totalã€‚æœ‰å¤šå°‘å°±çˆ¬å¤šå°‘</li>\n<li> è¾“å…¥æŒ‡å®šé¡µç èŒƒå›´ï¼Œçˆ¬å–æŒ‡å®šå¤šå°‘é¡µ</li>\n</ol>\n<p>å¦‚æœæ˜¯ç¬¬ä¸€ç§çš„è¯ï¼Œæˆ‘ä»¬è¿˜éœ€è¦è·å–åˆ°totalæ€»é¡µç æ•°ã€‚å› ä¸ºé¡µç æ˜¯æ‡’åŠ è½½çš„ï¼Œé¼ æ ‡æ»‘åŠ¨åˆ°åº•éƒ¨æ‰ä¼šè¯·æ±‚åŠ è½½ä¸‹ä¸€é¡µï¼Œè¿™ä¸ªæ—¶å€™æ‰èƒ½çœ‹åˆ°æ€»é¡µç ã€‚<br>æˆ‘æƒ³åˆ°äº†ä¸¤ç§æ€è·¯ï¼š</p>\n<ol>\n<li> ç›´æ¥è¯·æ±‚ç¬¬äºŒé¡µã€‚å¦‚æœå­˜åœ¨çš„è¯ï¼Œå°±è·å–åˆ°æ€»é¡µç ï¼Œå¦‚æœä¸å­˜åœ¨ç¬¬äºŒé¡µè¯´æ˜è¿™ä¸ªåªæœ‰ä¸€é¡µï¼Œè¿”å›1ã€‚</li>\n<li> ä½¿ç”¨seleniumåº“ï¼Œæ§åˆ¶é¼ æ ‡æ»‘åŠ¨é¡µç åˆ°åº•éƒ¨ï¼ŒåŠ è½½ä¸‹ä¸€é¡µï¼Œç„¶åè·å–æ€»é¡µç ã€‚</li>\n</ol>\n<p>æˆ‘æ„Ÿè§‰ä¸¤ç§æ–¹æ³•éƒ½å·®ä¸å¤šï¼Œå°±ç”¨ç®€å•ä¸€ç‚¹çš„ç¬¬ä¸€ç§æ–¹æ³•</p>\n<h4 id=\"è·å–æ€»é¡µç \"><a href=\"#è·å–æ€»é¡µç \" class=\"headerlink\" title=\"è·å–æ€»é¡µç \"></a>è·å–æ€»é¡µç </h4><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">\ndef get_num(type_index):\n    &quot;&quot;&quot; è·å–æ€»é¡µç \n    :param type_index:çˆ¬å–çš„ç±»å‹ç´¢å¼•\n    :return:å½“å‰çš„é¡µç æ•°é‡\n    &quot;&quot;&quot;\n    url &#x3D; &#39;https:&#x2F;&#x2F;wallhaven.cc&#x2F;&#123;&#125;?page&#x3D;2&#39;.format(type_list[type_index])\n    selector &#x3D; etree.HTML(requests.get(url, headers&#x3D;headers).text)\n    page_num &#x3D; selector.xpath(&#39;&#x2F;&#x2F;header[@class&#x3D;\\&#39;thumb-listing-page-header\\&#39;]&#x2F;h2&#x2F;&#x2F;text()&#39;)\n    return &#39;&#39;.join(page_num).split(&#39; &#39;)[-1]</code></pre>\n\n<h4 id=\"çˆ¬å–æŒ‡å®šç±»å‹ï¼Œé¡µç èŒƒå›´orçˆ¬å–å…¨éƒ¨é¡µ\"><a href=\"#çˆ¬å–æŒ‡å®šç±»å‹ï¼Œé¡µç èŒƒå›´orçˆ¬å–å…¨éƒ¨é¡µ\" class=\"headerlink\" title=\"çˆ¬å–æŒ‡å®šç±»å‹ï¼Œé¡µç èŒƒå›´orçˆ¬å–å…¨éƒ¨é¡µ\"></a>çˆ¬å–æŒ‡å®šç±»å‹ï¼Œé¡µç èŒƒå›´orçˆ¬å–å…¨éƒ¨é¡µ</h4><p>å¾ªç¯èµ·å§‹é¡µåˆ°æœ€åé¡µï¼Œæ— éå°±æ˜¯åœ¨çˆ¬å–å•é¡µçš„åŸºç¡€ä¸Šå†å¤šä¸€å±‚å¾ªç¯ã€‚<br>å¦‚æœä¸ä¼ å…¥å¼€å§‹é¡µç å’Œæœ€åé¡µç çš„è¯ï¼Œé‚£å¼€å§‹é¡µç å°±æ˜¯ç¬¬ä¸€é¡µï¼Œæ€»é¡µç å°±æ˜¯å½“å‰é¡µé¢æœ€åé¡µç </p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">\ndef get_total(type_index, start, end):\n    &quot;&quot;&quot;\n    çˆ¬å–æŒ‡å®šç±»å‹ï¼Œé¡µç èŒƒå›´\n    :param type_index:\n    :param start:\n    :param end:\n    :return:\n    &quot;&quot;&quot;\n    # total &#x3D; int(get_num(type_index))\n    if end is None:\n    \tend &#x3D; total\n    if start is None:\n        start &#x3D; 1\n    try:\n        for i in range(start, end):\n            url &#x3D; &#39;https:&#x2F;&#x2F;wallhaven.cc&#x2F;&#123;&#125;?page&#x3D;&#123;&#125;&#39;.format(type_list[type_index], i)\n            print(url, &#39;å¼€å§‹ä¸‹è½½ç¬¬&#123;&#125;&#x2F;&#123;&#125;é¡µ&#39;.format(i, end - 1))\n            res &#x3D; requests.get(url, headers&#x3D;headers).text\n            selector &#x3D; etree.HTML(res)\n            img_urls &#x3D; selector.xpath(&#39;&#x2F;&#x2F;a[@class&#x3D;\\&#39;preview\\&#39;]&#x2F;@href&#39;)\n            detail_img(img_urls)\n            # threading.Thread(target&#x3D;detail_img, args&#x3D;(img_urls)).start()\n    except Exception as e:\n        print(e)\n\n</code></pre>\n\n<p>è¿™æ˜¯è·å–åˆ°çš„å›¾ç‰‡ç»“æœ</p>\n<p><img src=\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/60be1f474036411a9946a99c4acd854f~tplv-k3u1fbpfcp-zoom-1.image\" alt=\"image.png\"></p>\n<h4 id=\"æœ€åæ˜¯æ‰€æœ‰ä»£ç \"><a href=\"#æœ€åæ˜¯æ‰€æœ‰ä»£ç \" class=\"headerlink\" title=\"æœ€åæ˜¯æ‰€æœ‰ä»£ç \"></a>æœ€åæ˜¯æ‰€æœ‰ä»£ç </h4><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">import os\nimport threading\n\nimport requests\nfrom lxml import etree\n\n&quot;&quot;&quot;\nçˆ¬å–ç½‘ç«™ï¼šhttps:&#x2F;&#x2F;wallhaven.cc&#x2F;\n&quot;&quot;&quot;\n# ä¼ªè£…æµè§ˆå™¨è¯·æ±‚\nheaders &#x3D; &#123;\n    &#39;user-agent&#39;: &#39;Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;106.0.0.0 Safari&#x2F;537.36&#39;\n&#125;\n# å­˜æ”¾ä¸‹è½½å›¾ç‰‡çš„æ–‡ä»¶å¤¹åç§°\nnew_folder &#x3D; &#39;img&#39;\n# 5ä¸ªæ¨¡å—å¯¹åº”çš„å­—ç¬¦ä¸²åˆ—è¡¨\ntype_list &#x3D; [&#39;hot&#39;, &#39;toplist&#39;, &#39;latest&#39;, &#39;random&#39;]\n# çº¿ç¨‹æ± \nthreads &#x3D; []\n\n\n# å•é¡µä¸‹è½½ï¼Œåªä¸‹è½½ä¸€é¡µ24å¼ å›¾ç‰‡\ndef get_wall_one_page(type_index: int, page_num) -&gt; None:\n    # page_numçˆ¬å–çš„é¡µç \n    url &#x3D; &#39;https:&#x2F;&#x2F;wallhaven.cc&#x2F;&#123;&#125;?page&#x3D;&#123;&#125;&#39;.format(type_list[type_index], page_num)\n    print(url)\n    # è·å–å½“å‰ç›®å½•\n    current_dir &#x3D; os.getcwd()\n\n    # æ–°æ–‡ä»¶å¤¹çš„åç§°\n    # new_folder &#x3D; &#39;img_&#123;&#125;&#39;.format(type_list[type_index])  # åˆ›å»ºæ–°æ–‡ä»¶å¤¹\n    if not os.path.exists(new_folder):\n        os.mkdir(os.path.join(current_dir, new_folder))\n\n    res &#x3D; requests.get(url, headers&#x3D;headers).text\n    selector &#x3D; etree.HTML(res)\n    img_urls &#x3D; selector.xpath(&#39;&#x2F;&#x2F;a[@class&#x3D;\\&#39;preview\\&#39;]&#x2F;@href&#39;)\n    detail_img(img_urls)\n\n\ndef detail_img(img_urls):\n    &quot;&quot;&quot;\n    å›¾ç‰‡è¯¦æƒ…\n    :param img_urls:è·å–åˆ°å•ä¸ªå›¾ç‰‡itemçš„è¯¦æƒ…url\n    :return:\n    &quot;&quot;&quot;\n    i &#x3D; 0\n\n    for item in img_urls:\n        son_res &#x3D; requests.get(item, headers&#x3D;headers).text\n        selector &#x3D; etree.HTML(son_res)\n        src_arr &#x3D; selector.xpath(&#39;&#x2F;&#x2F;img[@id&#x3D;\\&#39;wallpaper\\&#39;]&#x2F;@src&#39;)\n        # ä½¿ç”¨å¤šçº¿ç¨‹ä¸‹è½½å›¾ç‰‡\n        t &#x3D; threading.Thread(target&#x3D;download_img, args&#x3D;(src_arr[0], i))\n        t.start()\n        threads.append(t)\n        # download_img(src_arr[0], i)\n\n        i +&#x3D; 1\n        # ç­‰å¾…æ‰€æœ‰çº¿ç¨‹å®Œæˆ\n    for t in threads:\n        t.join()\n    print(&quot;å½“å‰é¡µæ‰€æœ‰å›¾ç‰‡ä¸‹è½½å®Œæˆ&quot;)\n\n\ndef download_img(img_src, i):\n    &quot;&quot;&quot;\n    å›¾ç‰‡ä¸‹è½½\n    :param img_src: å›¾ç‰‡çš„src\n    :param i: åºå·\n    :return: void\n    &quot;&quot;&quot;\n    with open(&#39;.&#x2F;&#123;&#125;&#x2F;&#123;&#125;-&#123;&#125;&#39;.format(new_folder, i, img_src.split(&#39;&#x2F;&#39;)[-1]), &#39;wb&#39;) as f:\n        f.write(requests.get(img_src).content)\n    print(i, img_src)\n\n\ndef get_num(type_index):\n    &quot;&quot;&quot; è·å–æ€»é¡µç \n    :param type_index:çˆ¬å–çš„ç±»å‹ç´¢å¼•\n    :return:å½“å‰çš„é¡µç æ•°é‡\n    &quot;&quot;&quot;\n    url &#x3D; &#39;https:&#x2F;&#x2F;wallhaven.cc&#x2F;&#123;&#125;?page&#x3D;2&#39;.format(type_list[type_index])\n    selector &#x3D; etree.HTML(requests.get(url, headers&#x3D;headers).text)\n    page_num &#x3D; selector.xpath(&#39;&#x2F;&#x2F;header[@class&#x3D;\\&#39;thumb-listing-page-header\\&#39;]&#x2F;h2&#x2F;&#x2F;text()&#39;)\n    return &#39;&#39;.join(page_num).split(&#39; &#39;)[-1]\n\n\ndef get_total(type_index, start, end):\n    &quot;&quot;&quot;\n    çˆ¬å–æŒ‡å®šç±»å‹ï¼Œé¡µç èŒƒå›´\n    :param type_index:\n    :param start:\n    :param end:\n    :return:\n    &quot;&quot;&quot;\n    # total &#x3D; int(get_num(type_index))\n    if end is None:\n    \tend &#x3D; total\n    if start is None:\n        start &#x3D; 1\n    try:\n        for i in range(start, end):\n            url &#x3D; &#39;https:&#x2F;&#x2F;wallhaven.cc&#x2F;&#123;&#125;?page&#x3D;&#123;&#125;&#39;.format(type_list[type_index], i)\n            print(url, &#39;å¼€å§‹ä¸‹è½½ç¬¬&#123;&#125;&#x2F;&#123;&#125;é¡µ&#39;.format(i, end - 1))\n            res &#x3D; requests.get(url, headers&#x3D;headers).text\n            selector &#x3D; etree.HTML(res)\n            img_urls &#x3D; selector.xpath(&#39;&#x2F;&#x2F;a[@class&#x3D;\\&#39;preview\\&#39;]&#x2F;@href&#39;)\n            detail_img(img_urls)\n            # threading.Thread(target&#x3D;detail_img, args&#x3D;(img_urls)).start()\n    except Exception as e:\n        print(e)\n\n\n# https:&#x2F;&#x2F;wallhaven.cc&#x2F;search?q&#x3D;code&amp;page&#x3D;1\n# todo æ ¹æ®è¾“å…¥å…³é”®è¯ï¼ŒæŸ¥æ‰¾ä¸‹è½½\n\nif __name__ &#x3D;&#x3D; &#39;__main__&#39;:\n    &quot;&quot;&quot;\n    0:&#39;hot&#39;, çƒ­æ¦œ\n    1:&#39;toplist&#39;, topæ’å\n    2:&#39;latest&#39;, æœ€æ–°\n    3:&#39;random&#39; éšæœº\n    4:&#39;search&#39; å…³é”®å­—æŸ¥æ‰¾\n    &quot;&quot;&quot;\n    get_wall_one_page(1,1)  # çˆ¬å–å•é¡µ\n    # get_total(2, 1, 11)  # çˆ¬å–å¤šä¸ªæŒ‡å®šé¡µç \n</code></pre>\n\n<p>ä¸Šé¢ä»£ç è¿˜æœ‰ä¼˜åŒ–çš„ç©ºé—´ï¼Œè¿˜å¯ä»¥åŠ å…¥å…³é”®è¯æŸ¥è¯¢çˆ¬å–ï¼Œè¿˜æœ‰æ ‡ç­¾çˆ¬å–ï¼Œæ¡ä»¶çˆ¬å–ç­‰ç­‰ï¼Œæ¬¢è¿è¯„è®ºä¸åŒæ„è§</p>\n<p>æƒ³è¦å£çº¸çš„ä¹Ÿå¯ä»¥ç§ä¿¡æˆ‘å‘ä½ ï¼</p>\n<p><img src=\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1cbeef7d5f534edfaa27f6d7da9df22e~tplv-k3u1fbpfcp-zoom-1.image\" alt=\"image.png\"></p>\n<p><img src=\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a296d571f77a40d0af9c0ed5a708e6ec~tplv-k3u1fbpfcp-zoom-1.image\" alt=\"0-wallhaven-d6w2dj.png\"></p>\n<p><img src=\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1405797418dc481892bfee79a2c1ac11~tplv-k3u1fbpfcp-zoom-1.image\" alt=\"6-wallhaven-7prmdv.jpg\"></p>\n<p>å–œæ¬¢æˆ‘çš„å°ä¼™ä¼´å¯ä»¥ç‚¹ä¸€æ³¢å…³æ³¨ã€‚ç‚¹ä¸ªèµ, æ¬¢è¿è¯„è®ºåŒºç•™è¨€è®¨è®º,çœ‹åˆ°ä¼šå›å¤.</p>\n","feature":false,"text":" å¤§å®¶å¥½æˆ‘æ˜¯å‰ç«¯å°‘å¹´æ±ªï¼ç—´è¿·æŠ€æœ¯ï¼Œå¯¹programmingæœ‰ç€æå¤§çš„å…´è¶£å’Œçˆ±å¥½ã€‚ä»æ˜å¤©èµ·ï¼Œåšä¸€ä¸ªæ–°æ€ç»´çš„äºº ç»§æ‰¿ï¼Œå¤šæ€ï¼Œå±‚å±‚å°è£… ä»æ˜å¤©èµ·,ä¸å†å…³å¿ƒå†…å­˜ç®¡ç† è®©æ¯ä¸€æ¡æ•°æ®ï¼Œè‡ªåŠ¨æ”¾åˆ°åˆé€‚çš„ä½å­ä¸Š ä»æ˜å¤©èµ·ï¼Œæˆ‘å°†ä¸ºæ¯ä¸€ä¸ªå¯¹è±¡ å–ä¸€ä¸ªæ¸©æš–çš„åå­— å®ƒä»¬ç”¨é©¼å³°å‘½åï¼Œä¼˜é›…ï¼Œå¤§æ–¹ é™Œç”Ÿäººï¼Œæˆ‘ä¹Ÿ...","link":"","photos":[],"count_time":{"symbolsCount":"9.5k","symbolsTime":"9 mins."},"categories":[{"name":"python","slug":"python","count":2,"path":"api/categories/python.json"}],"tags":[{"name":"çˆ¬è™«","slug":"çˆ¬è™«","count":2,"path":"api/tags/çˆ¬è™«.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%88%86%E6%9E%90%E7%9B%AE%E6%A0%87%E7%BD%91%E7%AB%99%E7%9A%84DOM%E7%BB%93%E6%9E%84\"><span class=\"toc-text\">åˆ†æç›®æ ‡ç½‘ç«™çš„DOMç»“æ„</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%A2%B3%E7%90%86%E4%B8%80%E4%B8%8B%E9%80%BB%E8%BE%91%EF%BC%9A\"><span class=\"toc-text\">æ¢³ç†ä¸€ä¸‹é€»è¾‘ï¼š</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0\"><span class=\"toc-text\">ä»£ç å®ç°</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%AF%BC%E5%85%A5%E7%9B%B8%E5%85%B3%E5%8C%85%EF%BC%8C%E5%AE%9A%E4%B9%89%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F\"><span class=\"toc-text\">å¯¼å…¥ç›¸å…³åŒ…ï¼Œå®šä¹‰å…¨å±€å˜é‡</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E8%8E%B7%E5%8F%96%E7%BC%A9%E7%95%A5%E5%9B%BE%E9%A1%B5%E9%9D%A2\"><span class=\"toc-text\">è·å–ç¼©ç•¥å›¾é¡µé¢</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E8%8E%B7%E5%8F%96%E5%9B%BE%E7%89%87%E8%AF%A6%E6%83%85%E9%A1%B5%E9%9D%A2\"><span class=\"toc-text\">è·å–å›¾ç‰‡è¯¦æƒ…é¡µé¢</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E4%B8%8B%E8%BD%BD%E5%9B%BE%E7%89%87\"><span class=\"toc-text\">ä¸‹è½½å›¾ç‰‡</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E8%8E%B7%E5%8F%96%E6%80%BB%E9%A1%B5%E7%A0%81\"><span class=\"toc-text\">è·å–æ€»é¡µç </span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E7%88%AC%E5%8F%96%E6%8C%87%E5%AE%9A%E7%B1%BB%E5%9E%8B%EF%BC%8C%E9%A1%B5%E7%A0%81%E8%8C%83%E5%9B%B4or%E7%88%AC%E5%8F%96%E5%85%A8%E9%83%A8%E9%A1%B5\"><span class=\"toc-text\">çˆ¬å–æŒ‡å®šç±»å‹ï¼Œé¡µç èŒƒå›´orçˆ¬å–å…¨éƒ¨é¡µ</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%9C%80%E5%90%8E%E6%98%AF%E6%89%80%E6%9C%89%E4%BB%A3%E7%A0%81\"><span class=\"toc-text\">æœ€åæ˜¯æ‰€æœ‰ä»£ç </span></a></li></ol></li></ol></li></ol>","author":{"name":"å‰ç«¯å°‘å¹´æ±ª","slug":"blog-author","avatar":"https://p3-passport.byteimg.com/img/user-avatar/46cf67c329246db441271a06f6132633~100x100.awebp","link":"/","description":"ä¸€ä¸ªè¿½é€æŠ€æœ¯çš„å…¨æ ˆå·¥ç¨‹å¸ˆ <br /> @ <b>å…¬ä¼—å·ï¼šå‰ç«¯å°‘å¹´æ±ª</b>","socials":{"github":"https://github.com/frontendBoy-Wang","twitter":"","stackoverflow":"https://stackoverflow.com/users/16856904/frontendboy-wang","wechat":"","qq":"","weibo":"","zhihu":"https://www.zhihu.com/people/qian-ke-sao-ren-wmq","csdn":"https://blog.csdn.net/qq_44647871?spm=1010.2135.3001.5421","juejin":"https://juejin.cn/user/3570847174897447","customs":{"bilibili":{"icon":"/svg/bilibili.svg","link":"https://space.bilibili.com/392982262"}}}},"mapped":true,"prev_post":{"title":"viteä½¿ç”¨å…¥é—¨","uid":"89c83197a75c1245116b0a9c7aba1d2b","slug":"vue/vite3ä½¿ç”¨æŒ‡å—,å°ç™½å†ä¹Ÿä¸ç”¨æ‹…å¿ƒé¡¹ç›®é…ç½®é—®é¢˜äº†","date":"2023-04-13T02:46:35.000Z","updated":"2024-12-25T06:40:06.000Z","comments":true,"path":"api/articles/vue/vite3ä½¿ç”¨æŒ‡å—,å°ç™½å†ä¹Ÿä¸ç”¨æ‹…å¿ƒé¡¹ç›®é…ç½®é—®é¢˜äº†.json","keywords":"å‰ç«¯å°‘å¹´æ±ª,å‰ç«¯,åç«¯,å…¨æ ˆå·¥ç¨‹å¸ˆ,ç¨‹åºå‘˜,vue,react,Golang,Java,JavaScript,Python,frontendBoy-Wang","cover":"../img/43.png","text":"ä¸ºå¼€å‘æä¾›æé€Ÿå“åº”v4.1.0 ç›®å‰Viteå·²ç»æ›´æ–°åˆ°v4.1.0çš„ç‰ˆæœ¬äº† viteçš„ç‰¹æ€§ ğŸ’¡æé€Ÿçš„æœåŠ¡å¯åŠ¨ï¼Œæ„æ€å°±æ˜¯ä¸€ä¸ªå­—å¿« âš¡ï¸è½»é‡å¿«é€Ÿçš„çƒ­é‡è½½ï¼Œå°±æ˜¯è¯´çƒ­æ›´æ–°ä¹Ÿå¾ˆå¿« ğŸ”§ä¸°å¯Œçš„åŠŸèƒ½ï¼Œæ”¯æŒçš„å·¥å…·é›†æ¯”è¾ƒå¤šï¼Œå¼€ç®±å³ç”¨ ğŸ“¦ä¼˜åŒ–çš„æ„å»º å¯¹äºç”Ÿäº§ç¯å¢ƒçš„æ„å»ºæœ‰æ›´å¥½çš„ä¼˜åŒ– ğŸ”©é€šç”¨çš„æ’ä»¶ï¼Œåœ¨å¼€å‘å’Œ...","link":"","photos":[],"count_time":{"symbolsCount":"6.6k","symbolsTime":"6 mins."},"categories":[{"name":"vite","slug":"vite","count":1,"path":"api/categories/vite.json"}],"tags":[{"name":"vite","slug":"vite","count":1,"path":"api/tags/vite.json"}],"author":{"name":"å‰ç«¯å°‘å¹´æ±ª","slug":"blog-author","avatar":"https://p3-passport.byteimg.com/img/user-avatar/46cf67c329246db441271a06f6132633~100x100.awebp","link":"/","description":"ä¸€ä¸ªè¿½é€æŠ€æœ¯çš„å…¨æ ˆå·¥ç¨‹å¸ˆ <br /> @ <b>å…¬ä¼—å·ï¼šå‰ç«¯å°‘å¹´æ±ª</b>","socials":{"github":"https://github.com/frontendBoy-Wang","twitter":"","stackoverflow":"https://stackoverflow.com/users/16856904/frontendboy-wang","wechat":"","qq":"","weibo":"","zhihu":"https://www.zhihu.com/people/qian-ke-sao-ren-wmq","csdn":"https://blog.csdn.net/qq_44647871?spm=1010.2135.3001.5421","juejin":"https://juejin.cn/user/3570847174897447","customs":{"bilibili":{"icon":"/svg/bilibili.svg","link":"https://space.bilibili.com/392982262"}}}},"feature":false},"next_post":{"title":"ä¸€éå°±èƒ½è¯»æ‡‚çš„WebSocketåè®®è¯¦è§£","uid":"f95adddbe06f4765087659d0718f1490","slug":"js/ä¸€éå°±èƒ½è¯»æ‡‚çš„WebSocketåè®®è¯¦è§£","date":"2023-04-04T13:46:35.000Z","updated":"2024-12-25T06:40:06.000Z","comments":true,"path":"api/articles/js/ä¸€éå°±èƒ½è¯»æ‡‚çš„WebSocketåè®®è¯¦è§£.json","keywords":"å‰ç«¯å°‘å¹´æ±ª,å‰ç«¯,åç«¯,å…¨æ ˆå·¥ç¨‹å¸ˆ,ç¨‹åºå‘˜,vue,react,Golang,Java,JavaScript,Python,frontendBoy-Wang","cover":"../img/0.png","text":"ä»€ä¹ˆæ˜¯WebSocketåè®®æ¦‚å¿µç”¨ä¸€å¥è¯è§£é‡Šä¸€ä¸‹: WebSocketåè®®æ˜¯ä¸€ç§åŸºäºTCPçš„ç½‘ç»œåè®®ï¼Œç”¨äºåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´å»ºç«‹æŒä¹…è¿æ¥ï¼Œå®ç°å…¨åŒå·¥é€šä¿¡,å®ƒå…è®¸æœåŠ¡å™¨ä¸»åŠ¨å‘å®¢æˆ·ç«¯æ¨é€æ•°æ®ï¼ŒåŒæ—¶ä¹Ÿå…è®¸å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€æ•°æ®ã€‚ WebSocketåè®®çš„ç‰¹ç‚¹1. è¾ƒä½çš„å¼€é”€ï¼š Web...","link":"","photos":[],"count_time":{"symbolsCount":"14k","symbolsTime":"13 mins."},"categories":[{"name":"ç½‘ç»œ","slug":"ç½‘ç»œ","count":2,"path":"api/categories/ç½‘ç»œ.json"},{"name":"TCP/IP","slug":"ç½‘ç»œ/TCP-IP","count":2,"path":"api/categories/ç½‘ç»œ/TCP-IP.json"},{"name":"HTTP","slug":"ç½‘ç»œ/TCP-IP/HTTP","count":2,"path":"api/categories/ç½‘ç»œ/TCP-IP/HTTP.json"}],"tags":[{"name":"ç½‘ç»œåè®®","slug":"ç½‘ç»œåè®®","count":2,"path":"api/tags/ç½‘ç»œåè®®.json"}],"author":{"name":"å‰ç«¯å°‘å¹´æ±ª","slug":"blog-author","avatar":"https://p3-passport.byteimg.com/img/user-avatar/46cf67c329246db441271a06f6132633~100x100.awebp","link":"/","description":"ä¸€ä¸ªè¿½é€æŠ€æœ¯çš„å…¨æ ˆå·¥ç¨‹å¸ˆ <br /> @ <b>å…¬ä¼—å·ï¼šå‰ç«¯å°‘å¹´æ±ª</b>","socials":{"github":"https://github.com/frontendBoy-Wang","twitter":"","stackoverflow":"https://stackoverflow.com/users/16856904/frontendboy-wang","wechat":"","qq":"","weibo":"","zhihu":"https://www.zhihu.com/people/qian-ke-sao-ren-wmq","csdn":"https://blog.csdn.net/qq_44647871?spm=1010.2135.3001.5421","juejin":"https://juejin.cn/user/3570847174897447","customs":{"bilibili":{"icon":"/svg/bilibili.svg","link":"https://space.bilibili.com/392982262"}}}},"feature":false}}